(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1556:e=>{e.exports={form:"styles_form__PXcis",slideUp:"styles_slideUp__WHfJZ",input:"styles_input__wAtPS","p-placeholder":"styles_p-placeholder__mCVqS","p-dropdown-trigger-icon":"styles_p-dropdown-trigger-icon__DidDX","p-focus":"styles_p-focus__LOoxy",submit:"styles_submit__fP6Vi",error:"styles_error__TmnKL",fieldGroup:"styles_fieldGroup__DwGsw",nameFields:"styles_nameFields__qoDAi",nameField:"styles_nameField__XvBN_",divider:"styles_divider__AEkHR",warningStep:"styles_warningStep__aSEKU",fadeIn:"styles_fadeIn__VOXj9",warningIcon:"styles_warningIcon__44CPq",pulse:"styles_pulse__UnNti",warningText:"styles_warningText__jNPU2"}},1867:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>k});var i=s(5155),t=s(2398),n=s(6798),l=s(5895),r=s(1832),d=s(7068),o=s.n(d),c=s(2115),u=s(5695),m=s(6766),_=s(2960),p=s(8363),h=s(6204),v=s(5657),x=s(2177),g=s(6277),y=s(6274),j=s(3844),E=s(7692),b=s(1556),N=s.n(b),f=s(5041),D=s(3319),R=s(7129),C=s(2461);let w=(e,a)=>{if(!e||!a)return!1;try{let[s,i]=a.split(":").map(e=>parseInt(e,10)),t=new Date(e);return t.setHours(s||0,i||0,0,0),t.getTime()>=Date.now()}catch(e){return!1}},T=R.Yj().transform(e=>"string"==typeof e?e.trim():e).required("Bu sahə m\xfctləqdir").min(2,"Minimum 2 simvol").max(40,"Maksimum 40 simvol").matches(RegExp("^[\\p{L}][\\p{L}\\p{M}\\s.'-]{1,39}$","u"),"Yalnız hərflər, boşluq, n\xf6qtə, tire və apostrof"),q=R.Ik({client_first_name:T.clone().required("Ad m\xfctləqdir"),client_last_name:T.clone().required("Soyad m\xfctləqdir"),services:R.YO(R.Ik({id:R.ai().required(),name:R.Yj().required()})).min(1,"Ən azı bir xidmət se\xe7in").required("Ən azı bir xidmət se\xe7in"),date:R.gl().required("Tarix se\xe7in").test("is-date","D\xfczg\xfcn tarix se\xe7in",e=>e instanceof Date&&!isNaN(e.getTime())),hour:R.Ik({time:R.Yj().required()}).nullable().required("Saat se\xe7in").test("has-time","Saat se\xe7in",e=>!!e&&"string"==typeof e.time&&e.time.length>0),doctor:R.Ik({id:R.ai().required(),full_name:R.Yj().required()}).nullable().required("Həkim se\xe7in")}).test("future-datetime","Ke\xe7miş zaman se\xe7ilə bilməz",e=>{var a,s,i;let t=null!=(s=e.date)?s:null,n=null!=(i=null==(a=e.hour)?void 0:a.time)?i:null;return!t||!n||w(t,n)}),I=e=>{let{visible:a,onHide:s,refetch:n}=e,[l,r]=(0,c.useState)("warning"),{control:d,handleSubmit:o,reset:u,watch:m,setValue:h,getValues:b,formState:{errors:R,isValid:w,isSubmitting:T}}=(0,x.mN)({mode:"onChange",reValidateMode:"onChange",resolver:(0,C.t)(q),shouldUnregister:!1,defaultValues:{client_first_name:"",client_last_name:"",services:[],doctor:null,date:void 0,hour:null}}),I=m("date"),O=m("hour"),{data:S=[],isLoading:k}=(0,_.I)({queryKey:["services"],queryFn:p.ju,enabled:a&&"form"===l}),{data:L=[],isLoading:P}=(0,_.I)({queryKey:["hours",I],queryFn:()=>(0,p.Tl)((0,D.GP)(I,"yyyy-MM-dd")),enabled:a&&"form"===l&&!!I}),{data:z=[],isLoading:A}=(0,_.I)({queryKey:["doctors",I,O],queryFn:()=>(0,p.ps)("".concat((0,D.GP)(I,"yyyy-MM-dd")," ").concat(null==O?void 0:O.time)),enabled:a&&"form"===l&&!!I&&!!(null==O?void 0:O.time)}),{mutate:H}=(0,f.n)({mutationFn:e=>(0,p.sH)(e)});return(0,i.jsx)(v.l,{header:"Yeni rezervasiya",visible:a,style:{width:"100%",maxWidth:"500px"},modal:!0,onHide:()=>{u(),r("warning"),s()},children:"warning"===l?(0,i.jsxs)("div",{className:N().warningStep,children:[(0,i.jsx)("div",{className:N().warningIcon,children:(0,i.jsx)("i",{className:"pi pi-info-circle"})}),(0,i.jsx)("p",{className:N().warningText,children:"Rezervasiya etdiyiniz zaman sizdən avans depozit istəniləcəkdir"}),(0,i.jsx)(t.$,{label:"Aydındır",onClick:()=>r("form"),className:N().submit})]}):(0,i.jsxs)("form",{onSubmit:o(e=>{var a;H({client_name:"".concat(e.client_first_name.trim()," ").concat(e.client_last_name.trim()),doctor_id:null==(a=e.doctor)?void 0:a.id,reservation_date:"".concat((0,D.GP)(e.date,"dd-MM-yyyy")," ").concat(e.hour.time),service_types:e.services.map(e=>({id:e.id}))},{onSuccess:()=>{u(),s(),n()}})}),className:N().form,children:[(0,i.jsxs)("div",{className:N().nameFields,children:[(0,i.jsxs)("div",{className:N().nameField,children:[(0,i.jsx)("label",{children:"Ad"}),(0,i.jsx)(x.xI,{name:"client_first_name",control:d,render:e=>{let{field:a}=e;return(0,i.jsx)(g.S,{...a,placeholder:"Adınızı daxil edin",className:"".concat(N().input," ").concat(R.client_first_name?"p-invalid":"")})}})]}),(0,i.jsxs)("div",{className:N().nameField,children:[(0,i.jsx)("label",{children:"Soyad"}),(0,i.jsx)(x.xI,{name:"client_last_name",control:d,render:e=>{let{field:a}=e;return(0,i.jsx)(g.S,{...a,placeholder:"Soyadınızı daxil edin",className:"".concat(N().input," ").concat(R.client_last_name?"p-invalid":"")})}})]})]}),(0,i.jsx)("label",{children:"Xidmətlər"}),(0,i.jsx)(x.xI,{name:"services",control:d,render:e=>{let{field:a}=e;return(0,i.jsx)(E.K,{...a,filter:!0,options:S,optionLabel:"name",placeholder:k?"Y\xfcklənir...":"Xidmət se\xe7in",className:"".concat(N().input," ").concat(R.services?"p-invalid":""),disabled:k,onChange:e=>a.onChange(e.value)})}}),(0,i.jsx)("label",{children:"Tarix"}),(0,i.jsx)(x.xI,{name:"date",control:d,render:e=>{let{field:a}=e;return(0,i.jsx)(y.V,{...a,dateFormat:"dd.mm.yy",minDate:new Date,showIcon:!0,className:"".concat(N().input," ").concat(R.date?"p-invalid":""),onChange:e=>{a.onChange(e.value),h("hour",null,{shouldValidate:!0}),h("doctor",null,{shouldValidate:!0})}})}}),(0,i.jsx)("label",{children:"Saat"}),(0,i.jsx)(x.xI,{name:"hour",control:d,render:e=>{let{field:a}=e;return(0,i.jsx)(j.m,{...a,options:L,optionLabel:"time",placeholder:P?"Y\xfcklənir...":"Saat se\xe7in",className:"".concat(N().input," ").concat(R.hour?"p-invalid":""),disabled:!I||P,onChange:e=>a.onChange(e.value)})}}),(0,i.jsx)("label",{children:"Həkim"}),(0,i.jsx)(x.xI,{name:"doctor",control:d,render:e=>{let{field:a}=e;return(0,i.jsx)(j.m,{...a,options:z,optionLabel:"full_name",placeholder:A?"Y\xfcklənir...":"Həkim se\xe7in",className:"".concat(N().input," ").concat(R.doctor?"p-invalid":""),disabled:!I||!(null==O?void 0:O.time)||A,onChange:e=>a.onChange(e.value)})}}),(0,i.jsx)(t.$,{type:"submit",label:T?"G\xf6ndərilir...":"Təsdiqlə",className:N().submit,disabled:!w||T})]})})};var O=function(e){return e[e.ORDER_REJECTED=0]="ORDER_REJECTED",e[e.ORDER_PLACED=1]="ORDER_PLACED",e[e.ORDER_ACCEPTED=2]="ORDER_ACCEPTED",e[e.ORDER_COMPLETED=3]="ORDER_COMPLETED",e}({});let S={[O.ORDER_REJECTED]:{label:"Ləğv olundu",severity:"danger"},[O.ORDER_PLACED]:{label:"Təsdiq g\xf6zlənilir",severity:"warning"},[O.ORDER_ACCEPTED]:{label:"Təsdiq olundu",severity:"success"},[O.ORDER_COMPLETED]:{label:"Tamamlandı",severity:"info"}};function k(){let e=(0,u.useRouter)(),[a,s]=(0,c.useState)(!1),[d,v]=(0,c.useState)(0);(0,c.useEffect)(()=>{localStorage.getItem("customerToken")||e.push("/login")},[e]);let{data:x,isLoading:g,refetch:y}=(0,_.I)({queryKey:["bookings"],queryFn:async()=>(0,p.dJ)()}),j=(null==x?void 0:x.data)||[],E=j.filter(e=>{var a,s;return(null==(a=e.customer_status)?void 0:a.status_id)===O.ORDER_PLACED||(null==(s=e.customer_status)?void 0:s.status_id)===O.ORDER_ACCEPTED}),b=j.filter(e=>{var a,s;return(null==(a=e.customer_status)?void 0:a.status_id)===O.ORDER_REJECTED||(null==(s=e.customer_status)?void 0:s.status_id)===O.ORDER_COMPLETED}),N=e=>{var a;return null!=(a=S[e])?a:{label:"Naməlum",severity:"secondary"}},f=e=>{var a,s,t;let l=N(null==(a=e.customer_status)?void 0:a.status_id);return(0,i.jsxs)(n.Z,{className:o().card,children:[(0,i.jsx)("div",{className:o().statusItem,children:(0,i.jsx)(r.v,{value:l.label,severity:l.severity})}),(0,i.jsxs)("div",{className:o().item,children:[(0,i.jsx)("i",{className:"pi pi-calendar"}),(0,i.jsx)("span",{className:o().label,children:"Tarix:"}),(0,i.jsx)("span",{className:o().value,children:null==(s=e.reservation_date)?void 0:s.split(" ")[0]})]}),(0,i.jsxs)("div",{className:o().item,children:[(0,i.jsx)("i",{className:"pi pi-clock"}),(0,i.jsx)("span",{className:o().label,children:"Saat:"}),(0,i.jsx)("span",{className:o().value,children:null==(t=e.reservation_date)?void 0:t.split(" ")[1]})]}),(0,i.jsxs)("div",{className:o().item,children:[(0,i.jsx)("i",{className:"pi pi-wallet"}),(0,i.jsx)("span",{className:o().label,children:"Məbləğ:"}),(0,i.jsxs)("span",{className:o().value,children:[e.total_amount," ₼"]})]}),(0,i.jsxs)("div",{className:o().item,children:[(0,i.jsx)("i",{className:"pi pi-user"}),(0,i.jsx)("span",{className:o().label,children:"M\xfcştəri:"}),(0,i.jsx)("span",{className:o().value,children:e.client_name})]}),(0,i.jsxs)("div",{className:o().item,children:[(0,i.jsx)("i",{className:"pi pi-phone"}),(0,i.jsx)("span",{className:o().label,children:"Telefon:"}),(0,i.jsx)("span",{className:o().value,children:e.client_phone})]})]},e.id)},D=e=>(0,i.jsxs)("div",{className:o().cardList,children:[e.map(f),!e.length&&!g&&(0,i.jsx)(h.Q,{severity:"secondary",text:"Rezervasiya m\xf6vc\xfcd deyil"})]});return(0,i.jsxs)("div",{className:o().page,children:[(0,i.jsxs)("header",{className:o().header,children:[(0,i.jsx)(m.default,{src:"/logo15.svg",alt:"logo",width:200,height:140}),(0,i.jsxs)("div",{className:o().header__actions,children:[(0,i.jsx)(t.$,{icon:"pi pi-plus",rounded:!0,"aria-label":"Yeni rezervasiya",onClick:()=>s(!0),className:o().addButton,tooltip:"Yeni rezervasiya",tooltipOptions:{position:"bottom"}}),(0,i.jsx)(t.$,{icon:"pi pi-sign-out",rounded:!0,className:o().logoutButton,onClick:()=>{localStorage.clear(),e.push("/login")},tooltip:"\xc7ıxış",tooltipOptions:{position:"bottom"}})]})]}),(0,i.jsxs)("main",{className:o().main,children:[g&&(0,i.jsx)("div",{className:o().loading,children:"Y\xfcklənir..."}),!g&&(0,i.jsxs)(l.J,{className:o().tabView,activeIndex:d,onTabChange:e=>v(e.index),children:[(0,i.jsx)(l.K,{header:"Aktiv rezervasiyalar",children:D(E)}),(0,i.jsx)(l.K,{header:"Bitmiş rezervasiyalar",children:D(b)})]})]}),(0,i.jsx)(I,{visible:a,onHide:()=>s(!1),refetch:y})]})}},7068:e=>{e.exports={page:"page_page__KdIv3",header:"page_header__Tcoou",slideDown:"page_slideDown__NjHYc",header__actions:"page_header__actions__PnFn9",addButton:"page_addButton__PHKv8",logoutButton:"page_logoutButton__fiO0L",main:"page_main__akH3E",fadeIn:"page_fadeIn__rpXfV",loading:"page_loading__LeZ5m",spin:"page_spin__3FWvx",tabView:"page_tabView__eHerx",cardList:"page_cardList__wh_31",cardEnter:"page_cardEnter__PCrLz",card:"page_card___3JVW",statusItem:"page_statusItem__CbmcK",item:"page_item__E_GBt",label:"page_label__mJHLU",value:"page_value__S9tjH",emptyState:"page_emptyState__oM6hy"}},8363:(e,a,s)=>{"use strict";s.d(a,{sH:()=>m,Tl:()=>c,dJ:()=>d,ps:()=>u,ju:()=>o,U5:()=>l,i6:()=>r});var i=s(3464),t=s(5695);let n=i.A.create({baseURL:"https://api.nargizestetik.az/customer-api"});n.interceptors.request.use(e=>{let a=localStorage.getItem("customerToken");return a&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(a)),e}),n.interceptors.response.use(e=>null==e?void 0:e.data,async e=>{var a,s;return(e.response&&(null==(a=e.response)?void 0:a.data.message)==="USER_NOT_AUTHORIZED"?(localStorage.clear(),(0,t.redirect)("/login")):e.response&&(null==(s=e.response)?void 0:s.data.message)||e.message,e&&e.response)?Promise.reject(e):Promise.reject()});let l=e=>n.post("auth/otp/request",e),r=e=>n.post("auth/otp/verify",e),d=()=>n.get("/reservations"),o=async()=>{let{data:e}=await n.get("/service-types/input-search");return e},c=async e=>{let{data:a}=await n.get("/reservation-times/input-search?date=".concat(e));return a},u=async e=>{let{data:a}=await n.get("/reservations/users/input-search?date_time=".concat(e));return a},m=async e=>n.post("/reservations",e)},8460:(e,a,s)=>{Promise.resolve().then(s.bind(s,1867))}},e=>{var a=a=>e(e.s=a);e.O(0,[465,808,144,746,988,441,684,358],()=>a(8460)),_N_E=e.O()}]);