(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1556:e=>{e.exports={form:"styles_form__PXcis",slideUp:"styles_slideUp__WHfJZ",input:"styles_input__wAtPS","p-placeholder":"styles_p-placeholder__mCVqS","p-dropdown-trigger-icon":"styles_p-dropdown-trigger-icon__DidDX","p-focus":"styles_p-focus__LOoxy",submit:"styles_submit__fP6Vi",error:"styles_error__TmnKL",fieldGroup:"styles_fieldGroup__DwGsw",divider:"styles_divider__AEkHR",warningStep:"styles_warningStep__aSEKU",fadeIn:"styles_fadeIn__VOXj9",warningIcon:"styles_warningIcon__44CPq",pulse:"styles_pulse__UnNti",warningText:"styles_warningText__jNPU2"}},1867:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>q});var t=s(5155),i=s(2398),n=s(6798),l=s(5895),r=s(1832),o=s(7068),d=s.n(o),c=s(2115),u=s(5695),m=s(6766),_=s(2960),p=s(8363),v=s(6204),h=s(5657),g=s(2177),x=s(6277),y=s(6274),j=s(3844),E=s(7692),b=s(1556),N=s.n(b),f=s(5041),D=s(3319),R=s(7129),C=s(2461);let w=(e,a)=>{if(!e||!a)return!1;try{let[s,t]=a.split(":").map(e=>parseInt(e,10)),i=new Date(e);return i.setHours(s||0,t||0,0,0),i.getTime()>=Date.now()}catch(e){return!1}},T=R.Ik({client_name:R.Yj().transform(e=>"string"==typeof e?e.trim():e).required("M\xfcştəri adı m\xfctləqdir").min(2,"Minimum 2 simvol").max(80,"Maksimum 80 simvol").matches(RegExp("^[\\p{L}][\\p{L}\\p{M}\\s.'-]{1,79}$","u"),"Yalnız hərflər, boşluq, n\xf6qtə, tire və apostrof"),services:R.YO(R.Ik({id:R.ai().required(),name:R.Yj().required()})).min(1,"Ən azı bir xidmət se\xe7in").required("Ən azı bir xidmət se\xe7in"),date:R.gl().required("Tarix se\xe7in").test("is-date","D\xfczg\xfcn tarix se\xe7in",e=>e instanceof Date&&!isNaN(e.getTime())),hour:R.Ik({time:R.Yj().required()}).nullable().required("Saat se\xe7in").test("has-time","Saat se\xe7in",e=>!!e&&"string"==typeof e.time&&e.time.length>0),doctor:R.Ik({id:R.ai().required(),full_name:R.Yj().required()}).nullable().required("Həkim se\xe7in")}).test("future-datetime","Ke\xe7miş zaman se\xe7ilə bilməz",e=>{var a,s,t;let i=null!=(s=e.date)?s:null,n=null!=(t=null==(a=e.hour)?void 0:a.time)?t:null;return!i||!n||w(i,n)}),I=e=>{let{visible:a,onHide:s,refetch:n}=e,[l,r]=(0,c.useState)("warning"),{control:o,handleSubmit:d,reset:u,watch:m,setValue:v,getValues:b,formState:{errors:R,isValid:w,isSubmitting:I}}=(0,g.mN)({mode:"onChange",reValidateMode:"onChange",resolver:(0,C.t)(T),shouldUnregister:!1,defaultValues:{client_name:"",services:[],doctor:null,date:void 0,hour:null}}),O=m("date"),k=m("hour"),{data:q=[],isLoading:L}=(0,_.I)({queryKey:["services"],queryFn:p.ju}),{data:P=[],isLoading:S}=(0,_.I)({queryKey:["hours",O],queryFn:()=>(0,p.Tl)((0,D.GP)(O,"yyyy-MM-dd")),enabled:!!O}),{data:z=[],isLoading:M}=(0,_.I)({queryKey:["doctors",O,k],queryFn:()=>(0,p.ps)("".concat((0,D.GP)(O,"yyyy-MM-dd")," ").concat(null==k?void 0:k.time)),enabled:!!O&&!!(null==k?void 0:k.time)}),{mutate:H}=(0,f.n)({mutationFn:e=>(0,p.sH)(e)});return(0,t.jsx)(h.l,{header:"Yeni rezervasiya",visible:a,style:{width:"100%",maxWidth:"500px"},modal:!0,onHide:()=>{u(),r("warning"),s()},children:"warning"===l?(0,t.jsxs)("div",{className:N().warningStep,children:[(0,t.jsx)("div",{className:N().warningIcon,children:(0,t.jsx)("i",{className:"pi pi-info-circle"})}),(0,t.jsx)("p",{className:N().warningText,children:"Rezervasiya etdiyiniz zaman sizdən avans depozit istəniləcəkdir"}),(0,t.jsx)(i.$,{label:"Aydındır",onClick:()=>r("form"),className:N().submit})]}):(0,t.jsxs)("form",{onSubmit:d(e=>{var a;H({client_name:e.client_name,doctor_id:null==(a=e.doctor)?void 0:a.id,reservation_date:"".concat((0,D.GP)(e.date,"dd-MM-yyyy")," ").concat(e.hour.time),service_types:e.services.map(e=>({id:e.id}))},{onSuccess:()=>{u(),s(),n()}})}),className:N().form,children:[(0,t.jsx)("label",{children:"M\xfcştəri adı"}),(0,t.jsx)(g.xI,{name:"client_name",control:o,render:e=>{let{field:a}=e;return(0,t.jsx)(x.S,{...a,className:"".concat(N().input," ").concat(R.client_name?"p-invalid":"")})}}),(0,t.jsx)("label",{children:"Xidmətlər"}),(0,t.jsx)(g.xI,{name:"services",control:o,render:e=>{let{field:a}=e;return(0,t.jsx)(E.K,{...a,filter:!0,options:q,optionLabel:"name",placeholder:L?"Y\xfcklənir...":"Xidmət se\xe7in",className:"".concat(N().input," ").concat(R.services?"p-invalid":""),disabled:L,onChange:e=>a.onChange(e.value)})}}),(0,t.jsx)("label",{children:"Tarix"}),(0,t.jsx)(g.xI,{name:"date",control:o,render:e=>{let{field:a}=e;return(0,t.jsx)(y.V,{...a,dateFormat:"dd.mm.yy",minDate:new Date,showIcon:!0,className:"".concat(N().input," ").concat(R.date?"p-invalid":""),onChange:e=>{a.onChange(e.value),v("hour",null,{shouldValidate:!0}),v("doctor",null,{shouldValidate:!0})}})}}),(0,t.jsx)("label",{children:"Saat"}),(0,t.jsx)(g.xI,{name:"hour",control:o,render:e=>{let{field:a}=e;return(0,t.jsx)(j.m,{...a,options:P,optionLabel:"time",placeholder:S?"Y\xfcklənir...":"Saat se\xe7in",className:"".concat(N().input," ").concat(R.hour?"p-invalid":""),disabled:!O||S,onChange:e=>a.onChange(e.value)})}}),(0,t.jsx)("label",{children:"Həkim"}),(0,t.jsx)(g.xI,{name:"doctor",control:o,render:e=>{let{field:a}=e;return(0,t.jsx)(j.m,{...a,options:z,optionLabel:"full_name",placeholder:M?"Y\xfcklənir...":"Həkim se\xe7in",className:"".concat(N().input," ").concat(R.doctor?"p-invalid":""),disabled:!O||!(null==k?void 0:k.time)||M,onChange:e=>a.onChange(e.value)})}}),(0,t.jsx)(i.$,{type:"submit",label:I?"G\xf6ndərilir...":"Təsdiqlə",className:N().submit,disabled:!w||I})]})})};var O=function(e){return e[e.ORDER_REJECTED=0]="ORDER_REJECTED",e[e.ORDER_PLACED=1]="ORDER_PLACED",e[e.ORDER_ACCEPTED=2]="ORDER_ACCEPTED",e[e.ORDER_COMPLETED=3]="ORDER_COMPLETED",e}({});let k={[O.ORDER_REJECTED]:{label:"Ləğv olundu",severity:"danger"},[O.ORDER_PLACED]:{label:"Təsdiq g\xf6zlənilir",severity:"warning"},[O.ORDER_ACCEPTED]:{label:"Təsdiq olundu",severity:"success"},[O.ORDER_COMPLETED]:{label:"Tamamlandı",severity:"info"}};function q(){let e=(0,u.useRouter)(),[a,s]=(0,c.useState)(!1),[o,h]=(0,c.useState)(0);(0,c.useEffect)(()=>{localStorage.getItem("customerToken")||e.push("/login")},[e]);let{data:g,isLoading:x,refetch:y}=(0,_.I)({queryKey:["bookings"],queryFn:async()=>(0,p.dJ)()}),j=(null==g?void 0:g.data)||[],E=j.filter(e=>{var a,s;return(null==(a=e.customer_status)?void 0:a.status_id)===O.ORDER_PLACED||(null==(s=e.customer_status)?void 0:s.status_id)===O.ORDER_ACCEPTED}),b=j.filter(e=>{var a,s;return(null==(a=e.customer_status)?void 0:a.status_id)===O.ORDER_REJECTED||(null==(s=e.customer_status)?void 0:s.status_id)===O.ORDER_COMPLETED}),N=e=>{var a;return null!=(a=k[e])?a:{label:"Naməlum",severity:"secondary"}},f=e=>{var a,s,i;let l=N(null==(a=e.customer_status)?void 0:a.status_id);return(0,t.jsxs)(n.Z,{className:d().card,children:[(0,t.jsx)("div",{className:d().statusItem,children:(0,t.jsx)(r.v,{value:l.label,severity:l.severity})}),(0,t.jsxs)("div",{className:d().item,children:[(0,t.jsx)("i",{className:"pi pi-calendar"}),(0,t.jsx)("span",{className:d().label,children:"Tarix:"}),(0,t.jsx)("span",{className:d().value,children:null==(s=e.reservation_date)?void 0:s.split(" ")[0]})]}),(0,t.jsxs)("div",{className:d().item,children:[(0,t.jsx)("i",{className:"pi pi-clock"}),(0,t.jsx)("span",{className:d().label,children:"Saat:"}),(0,t.jsx)("span",{className:d().value,children:null==(i=e.reservation_date)?void 0:i.split(" ")[1]})]}),(0,t.jsxs)("div",{className:d().item,children:[(0,t.jsx)("i",{className:"pi pi-wallet"}),(0,t.jsx)("span",{className:d().label,children:"Məbləğ:"}),(0,t.jsxs)("span",{className:d().value,children:[e.total_amount," ₼"]})]}),(0,t.jsxs)("div",{className:d().item,children:[(0,t.jsx)("i",{className:"pi pi-user"}),(0,t.jsx)("span",{className:d().label,children:"M\xfcştəri:"}),(0,t.jsx)("span",{className:d().value,children:e.client_name})]}),(0,t.jsxs)("div",{className:d().item,children:[(0,t.jsx)("i",{className:"pi pi-phone"}),(0,t.jsx)("span",{className:d().label,children:"Telefon:"}),(0,t.jsx)("span",{className:d().value,children:e.client_phone})]})]},e.id)},D=e=>(0,t.jsxs)("div",{className:d().cardList,children:[e.map(f),!e.length&&!x&&(0,t.jsx)(v.Q,{severity:"secondary",text:"Rezervasiya m\xf6vc\xfcd deyil"})]});return(0,t.jsxs)("div",{className:d().page,children:[(0,t.jsxs)("header",{className:d().header,children:[(0,t.jsx)(m.default,{src:"/logo15.svg",alt:"logo",width:200,height:140}),(0,t.jsxs)("div",{className:d().header__actions,children:[(0,t.jsx)(i.$,{icon:"pi pi-plus",rounded:!0,"aria-label":"Yeni rezervasiya",onClick:()=>s(!0),className:d().addButton,tooltip:"Yeni rezervasiya",tooltipOptions:{position:"bottom"}}),(0,t.jsx)(i.$,{icon:"pi pi-sign-out",rounded:!0,className:d().logoutButton,onClick:()=>{localStorage.clear(),e.push("/login")},tooltip:"\xc7ıxış",tooltipOptions:{position:"bottom"}})]})]}),(0,t.jsxs)("main",{className:d().main,children:[x&&(0,t.jsx)("div",{className:d().loading,children:"Y\xfcklənir..."}),!x&&(0,t.jsxs)(l.J,{className:d().tabView,activeIndex:o,onTabChange:e=>h(e.index),children:[(0,t.jsx)(l.K,{header:"Aktiv rezervasiyalar",children:D(E)}),(0,t.jsx)(l.K,{header:"Bitmiş rezervasiyalar",children:D(b)})]})]}),(0,t.jsx)(I,{visible:a,onHide:()=>s(!1),refetch:y})]})}},7068:e=>{e.exports={page:"page_page__KdIv3",header:"page_header__Tcoou",slideDown:"page_slideDown__NjHYc",header__actions:"page_header__actions__PnFn9",addButton:"page_addButton__PHKv8",logoutButton:"page_logoutButton__fiO0L",main:"page_main__akH3E",fadeIn:"page_fadeIn__rpXfV",loading:"page_loading__LeZ5m",spin:"page_spin__3FWvx",tabView:"page_tabView__eHerx",cardList:"page_cardList__wh_31",cardEnter:"page_cardEnter__PCrLz",card:"page_card___3JVW",statusItem:"page_statusItem__CbmcK",item:"page_item__E_GBt",label:"page_label__mJHLU",value:"page_value__S9tjH",emptyState:"page_emptyState__oM6hy"}},8363:(e,a,s)=>{"use strict";s.d(a,{sH:()=>m,Tl:()=>c,dJ:()=>o,ps:()=>u,ju:()=>d,U5:()=>l,i6:()=>r});var t=s(3464),i=s(5695);let n=t.A.create({baseURL:"https://dev-api.nargizestetik.az/customer-api"});n.interceptors.request.use(e=>{let a=localStorage.getItem("customerToken");return a&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(a)),e}),n.interceptors.response.use(e=>null==e?void 0:e.data,async e=>{var a,s;return(e.response&&(null==(a=e.response)?void 0:a.data.message)==="USER_NOT_AUTHORIZED"?(localStorage.clear(),(0,i.redirect)("/login")):e.response&&(null==(s=e.response)?void 0:s.data.message)||e.message,e&&e.response)?Promise.reject(e):Promise.reject()});let l=e=>n.post("auth/otp/request",e),r=e=>n.post("auth/otp/verify",e),o=()=>n.get("/reservations"),d=async()=>{let{data:e}=await n.get("/service-types/input-search");return e},c=async e=>{let{data:a}=await n.get("/reservation-times/input-search?date=".concat(e));return a},u=async e=>{let{data:a}=await n.get("/reservations/users/input-search?date_time=".concat(e));return a},m=async e=>n.post("/reservations",e)},8460:(e,a,s)=>{Promise.resolve().then(s.bind(s,1867))}},e=>{var a=a=>e(e.s=a);e.O(0,[465,808,144,737,687,441,684,358],()=>a(8460)),_N_E=e.O()}]);