(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1556:e=>{e.exports={form:"styles_form__PXcis",slideUp:"styles_slideUp__WHfJZ",input:"styles_input__wAtPS","p-placeholder":"styles_p-placeholder__mCVqS","p-dropdown-trigger-icon":"styles_p-dropdown-trigger-icon__DidDX","p-focus":"styles_p-focus__LOoxy",submit:"styles_submit__fP6Vi",error:"styles_error__TmnKL",fieldGroup:"styles_fieldGroup__DwGsw",divider:"styles_divider__AEkHR"}},1867:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>I});var t=s(5155),i=s(2398),l=s(6798),r=s(5895),n=s(1832),o=s(7068),d=s.n(o),c=s(2115),u=s(5695),m=s(6766),_=s(2960),p=s(8363),h=s(6204),v=s(5657),g=s(2177),x=s(6277),y=s(6274),j=s(3844),E=s(7692),b=s(1556),N=s.n(b),D=s(5041),R=s(3319),f=s(7129),C=s(2461);let T=(e,a)=>{if(!e||!a)return!1;try{let[s,t]=a.split(":").map(e=>parseInt(e,10)),i=new Date(e);return i.setHours(s||0,t||0,0,0),i.getTime()>=Date.now()}catch(e){return!1}},O=f.Ik({client_name:f.Yj().transform(e=>"string"==typeof e?e.trim():e).required("M\xfcştəri adı m\xfctləqdir").min(2,"Minimum 2 simvol").max(80,"Maksimum 80 simvol").matches(RegExp("^[\\p{L}][\\p{L}\\p{M}\\s.'-]{1,79}$","u"),"Yalnız hərflər, boşluq, n\xf6qtə, tire və apostrof"),services:f.YO(f.Ik({id:f.ai().required(),name:f.Yj().required()})).min(1,"Ən azı bir xidmət se\xe7in").required("Ən azı bir xidmət se\xe7in"),date:f.gl().required("Tarix se\xe7in").test("is-date","D\xfczg\xfcn tarix se\xe7in",e=>e instanceof Date&&!isNaN(e.getTime())),hour:f.Ik({time:f.Yj().required()}).nullable().required("Saat se\xe7in").test("has-time","Saat se\xe7in",e=>!!e&&"string"==typeof e.time&&e.time.length>0),doctor:f.Ik({id:f.ai().required(),full_name:f.Yj().required()}).nullable().required("Həkim se\xe7in")}).test("future-datetime","Ke\xe7miş zaman se\xe7ilə bilməz",e=>{var a,s,t;let i=null!=(s=e.date)?s:null,l=null!=(t=null==(a=e.hour)?void 0:a.time)?t:null;return!i||!l||T(i,l)}),q=e=>{let{visible:a,onHide:s,refetch:l}=e,{control:r,handleSubmit:n,reset:o,watch:d,setValue:c,getValues:u,formState:{errors:m,isValid:h,isSubmitting:b}}=(0,g.mN)({mode:"onChange",reValidateMode:"onChange",resolver:(0,C.t)(O),shouldUnregister:!1,defaultValues:{client_name:"",services:[],doctor:null,date:void 0,hour:null}}),f=d("date"),T=d("hour"),{data:q=[],isLoading:L}=(0,_.I)({queryKey:["services"],queryFn:p.ju}),{data:k=[],isLoading:I}=(0,_.I)({queryKey:["hours",f],queryFn:()=>(0,p.Tl)((0,R.GP)(f,"yyyy-MM-dd")),enabled:!!f}),{data:w=[],isLoading:P}=(0,_.I)({queryKey:["doctors",f,T],queryFn:()=>(0,p.ps)("".concat((0,R.GP)(f,"yyyy-MM-dd")," ").concat(null==T?void 0:T.time)),enabled:!!f&&!!(null==T?void 0:T.time)}),{mutate:S}=(0,D.n)({mutationFn:e=>(0,p.sH)(e)});return(0,t.jsx)(v.l,{header:"Yeni rezervasiya",visible:a,style:{width:"100%",maxWidth:"500px"},modal:!0,onHide:()=>{o(),s()},children:(0,t.jsxs)("form",{onSubmit:n(e=>{var a;S({client_name:e.client_name,doctor_id:null==(a=e.doctor)?void 0:a.id,reservation_date:"".concat((0,R.GP)(e.date,"dd-MM-yyyy")," ").concat(e.hour.time),service_types:e.services.map(e=>({id:e.id}))},{onSuccess:()=>{o(),s(),l()}})}),className:N().form,children:[(0,t.jsx)("label",{children:"M\xfcştəri adı"}),(0,t.jsx)(g.xI,{name:"client_name",control:r,render:e=>{let{field:a}=e;return(0,t.jsx)(x.S,{...a,className:"".concat(N().input," ").concat(m.client_name?"p-invalid":"")})}}),(0,t.jsx)("label",{children:"Xidmətlər"}),(0,t.jsx)(g.xI,{name:"services",control:r,render:e=>{let{field:a}=e;return(0,t.jsx)(E.K,{...a,filter:!0,options:q,optionLabel:"name",placeholder:L?"Y\xfcklənir...":"Xidmət se\xe7in",className:"".concat(N().input," ").concat(m.services?"p-invalid":""),disabled:L,onChange:e=>a.onChange(e.value)})}}),(0,t.jsx)("label",{children:"Tarix"}),(0,t.jsx)(g.xI,{name:"date",control:r,render:e=>{let{field:a}=e;return(0,t.jsx)(y.V,{...a,dateFormat:"dd.mm.yy",minDate:new Date,showIcon:!0,className:"".concat(N().input," ").concat(m.date?"p-invalid":""),onChange:e=>{a.onChange(e.value),c("hour",null,{shouldValidate:!0}),c("doctor",null,{shouldValidate:!0})}})}}),(0,t.jsx)("label",{children:"Saat"}),(0,t.jsx)(g.xI,{name:"hour",control:r,render:e=>{let{field:a}=e;return(0,t.jsx)(j.m,{...a,options:k,optionLabel:"time",placeholder:I?"Y\xfcklənir...":"Saat se\xe7in",className:"".concat(N().input," ").concat(m.hour?"p-invalid":""),disabled:!f||I,onChange:e=>a.onChange(e.value)})}}),(0,t.jsx)("label",{children:"Həkim"}),(0,t.jsx)(g.xI,{name:"doctor",control:r,render:e=>{let{field:a}=e;return(0,t.jsx)(j.m,{...a,options:w,optionLabel:"full_name",placeholder:P?"Y\xfcklənir...":"Həkim se\xe7in",className:"".concat(N().input," ").concat(m.doctor?"p-invalid":""),disabled:!f||!(null==T?void 0:T.time)||P,onChange:e=>a.onChange(e.value)})}}),(0,t.jsx)(i.$,{type:"submit",label:b?"G\xf6ndərilir...":"Təsdiqlə",className:N().submit,disabled:!h||b})]})})};var L=function(e){return e[e.ORDER_REJECTED=0]="ORDER_REJECTED",e[e.ORDER_PLACED=1]="ORDER_PLACED",e[e.ORDER_ACCEPTED=2]="ORDER_ACCEPTED",e[e.ORDER_COMPLETED=3]="ORDER_COMPLETED",e}({});let k={[L.ORDER_REJECTED]:{label:"Ləğv olundu",severity:"danger"},[L.ORDER_PLACED]:{label:"Təsdiq g\xf6zlənilir",severity:"warning"},[L.ORDER_ACCEPTED]:{label:"Təsdiq olundu",severity:"success"},[L.ORDER_COMPLETED]:{label:"Tamamlandı",severity:"info"}};function I(){let e=(0,u.useRouter)(),[a,s]=(0,c.useState)(!1),[o,v]=(0,c.useState)(0);(0,c.useEffect)(()=>{localStorage.getItem("customerToken")||e.push("/login")},[e]);let{data:g,isLoading:x,refetch:y}=(0,_.I)({queryKey:["bookings"],queryFn:async()=>(0,p.dJ)()}),j=(null==g?void 0:g.data)||[],E=j.filter(e=>{var a,s;return(null==(a=e.customer_status)?void 0:a.status_id)===L.ORDER_PLACED||(null==(s=e.customer_status)?void 0:s.status_id)===L.ORDER_ACCEPTED}),b=j.filter(e=>{var a,s;return(null==(a=e.customer_status)?void 0:a.status_id)===L.ORDER_REJECTED||(null==(s=e.customer_status)?void 0:s.status_id)===L.ORDER_COMPLETED}),N=e=>{var a;return null!=(a=k[e])?a:{label:"Naməlum",severity:"secondary"}},D=e=>{var a,s,i;let r=N(null==(a=e.customer_status)?void 0:a.status_id);return(0,t.jsxs)(l.Z,{className:d().card,children:[(0,t.jsx)("div",{className:d().statusItem,children:(0,t.jsx)(n.v,{value:r.label,severity:r.severity})}),(0,t.jsxs)("div",{className:d().item,children:[(0,t.jsx)("i",{className:"pi pi-calendar"}),(0,t.jsx)("span",{className:d().label,children:"Tarix:"}),(0,t.jsx)("span",{className:d().value,children:null==(s=e.reservation_date)?void 0:s.split(" ")[0]})]}),(0,t.jsxs)("div",{className:d().item,children:[(0,t.jsx)("i",{className:"pi pi-clock"}),(0,t.jsx)("span",{className:d().label,children:"Saat:"}),(0,t.jsx)("span",{className:d().value,children:null==(i=e.reservation_date)?void 0:i.split(" ")[1]})]}),(0,t.jsxs)("div",{className:d().item,children:[(0,t.jsx)("i",{className:"pi pi-wallet"}),(0,t.jsx)("span",{className:d().label,children:"Məbləğ:"}),(0,t.jsxs)("span",{className:d().value,children:[e.total_amount," ₼"]})]}),(0,t.jsxs)("div",{className:d().item,children:[(0,t.jsx)("i",{className:"pi pi-user"}),(0,t.jsx)("span",{className:d().label,children:"M\xfcştəri:"}),(0,t.jsx)("span",{className:d().value,children:e.client_name})]}),(0,t.jsxs)("div",{className:d().item,children:[(0,t.jsx)("i",{className:"pi pi-phone"}),(0,t.jsx)("span",{className:d().label,children:"Telefon:"}),(0,t.jsx)("span",{className:d().value,children:e.client_phone})]})]},e.id)},R=e=>(0,t.jsxs)("div",{className:d().cardList,children:[e.map(D),!e.length&&!x&&(0,t.jsx)(h.Q,{severity:"secondary",text:"Rezervasiya m\xf6vc\xfcd deyil"})]});return(0,t.jsxs)("div",{className:d().page,children:[(0,t.jsxs)("header",{className:d().header,children:[(0,t.jsx)(m.default,{src:"/logo15.svg",alt:"logo",width:200,height:140}),(0,t.jsxs)("div",{className:d().header__actions,children:[(0,t.jsx)(i.$,{icon:"pi pi-plus",rounded:!0,"aria-label":"Yeni rezervasiya",onClick:()=>s(!0),className:d().addButton,tooltip:"Yeni rezervasiya",tooltipOptions:{position:"bottom"}}),(0,t.jsx)(i.$,{icon:"pi pi-sign-out",rounded:!0,className:d().logoutButton,onClick:()=>{localStorage.clear(),e.push("/login")},tooltip:"\xc7ıxış",tooltipOptions:{position:"bottom"}})]})]}),(0,t.jsxs)("main",{className:d().main,children:[x&&(0,t.jsx)("div",{className:d().loading,children:"Y\xfcklənir..."}),!x&&(0,t.jsxs)(r.J,{className:d().tabView,activeIndex:o,onTabChange:e=>v(e.index),children:[(0,t.jsx)(r.K,{header:"Aktiv rezervasiyalar",children:R(E)}),(0,t.jsx)(r.K,{header:"Bitmiş rezervasiyalar",children:R(b)})]})]}),(0,t.jsx)(q,{visible:a,onHide:()=>s(!1),refetch:y})]})}},7068:e=>{e.exports={page:"page_page__KdIv3",header:"page_header__Tcoou",slideDown:"page_slideDown__NjHYc",header__actions:"page_header__actions__PnFn9",addButton:"page_addButton__PHKv8",logoutButton:"page_logoutButton__fiO0L",main:"page_main__akH3E",fadeIn:"page_fadeIn__rpXfV",loading:"page_loading__LeZ5m",spin:"page_spin__3FWvx",tabView:"page_tabView__eHerx",cardList:"page_cardList__wh_31",cardEnter:"page_cardEnter__PCrLz",card:"page_card___3JVW",statusItem:"page_statusItem__CbmcK",item:"page_item__E_GBt",label:"page_label__mJHLU",value:"page_value__S9tjH",emptyState:"page_emptyState__oM6hy"}},8363:(e,a,s)=>{"use strict";s.d(a,{sH:()=>m,Tl:()=>c,dJ:()=>o,ps:()=>u,ju:()=>d,U5:()=>r,i6:()=>n});var t=s(3464),i=s(5695);let l=t.A.create({baseURL:"https://dev-api.nargizestetik.az/customer-api"});l.interceptors.request.use(e=>{let a=localStorage.getItem("customerToken");return a&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(a)),e}),l.interceptors.response.use(e=>null==e?void 0:e.data,async e=>{var a,s;return(e.response&&(null==(a=e.response)?void 0:a.data.message)==="USER_NOT_AUTHORIZED"?(localStorage.clear(),(0,i.redirect)("/login")):e.response&&(null==(s=e.response)?void 0:s.data.message)||e.message,e&&e.response)?Promise.reject(e):Promise.reject()});let r=e=>l.post("auth/otp/request",e),n=e=>l.post("auth/otp/verify",e),o=()=>l.get("/reservations"),d=async()=>{let{data:e}=await l.get("/service-types/input-search");return e},c=async e=>{let{data:a}=await l.get("/reservation-times/input-search?date=".concat(e));return a},u=async e=>{let{data:a}=await l.get("/reservations/users/input-search?date_time=".concat(e));return a},m=async e=>l.post("/reservations",e)},8460:(e,a,s)=>{Promise.resolve().then(s.bind(s,1867))}},e=>{var a=a=>e(e.s=a);e.O(0,[465,808,144,737,687,441,684,358],()=>a(8460)),_N_E=e.O()}]);